---
import { Image } from "astro:assets";
const { src, alt } = Astro.props;
---

<div><Image src={src} inferSize alt={alt} loading='lazy' decoding='async' data-zoomable /></div>

<script>
  import posthog from "posthog-js";
  import mediumZoom from "medium-zoom";

  const zoom = mediumZoom("[data-zoomable]", {
    background: "var(--background)",
    margin: 64,
    scrollOffset: 0,
  });

  zoom.on("open", (event) => {
    const { alt, src } = event.target;
    posthog.capture("image_zoomed", { alt, img_src: src });
  });
</script>

<style>
  div:has(> img) {
    position: relative;
    width: 100%;
    height: fit-content;
    overflow: hidden;
    border: 1px solid var(--foreground);
    border-radius: 1rem;
    display: block;
    box-shadow:
      0px 10px 15px -3px rgba(0, 0, 0, 0.1),
      0px 4px 6px -2px rgba(0, 0, 0, 0.05);
  }
  img {
    position: relative;
    width: 100%;
    height: auto;
  }
</style>
